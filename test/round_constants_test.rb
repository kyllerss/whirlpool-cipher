# To change this template, choose Tools | Templates
# and open the template in the editor.

$:.unshift File.join(File.dirname(__FILE__),'..','lib')

require 'test/unit'
require 'round_constants'
require 'sbox'

class RoundConstantsTest < Test::Unit::TestCase

  def test_round_constant_3

    sbox_manager = SBox.new
    round_constants_manager = RoundConstants.new(sbox_manager)

    expected_matrix = [[0x60, 0xBC, 0x9B, 0x8E, 0xA3, 0x0C, 0x7B, 0x35],
                       [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00],
                       [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00],
                       [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00],
                       [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00],
                       [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00],
                       [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00],
                       [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]]

    round_constant_3 = round_constants_manager.get_round(3)

    assert_equal expected_matrix, round_constant_3
  end
end
